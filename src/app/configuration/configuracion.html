<div class="main-wrapper">
  <div class="top-header">
    <button class="menu-button" (click)="toggleMenu()">
      <span class="material-symbols-outlined">dehaze</span>
    </button>
    <h1>Configuraci√≥n</h1>
  </div>

  <div class="sidebar-menu" [class.open]="menuAbierto">
    <div class="menu-header">
      <h2>Men√∫</h2>
      <button class="close-button" (click)="toggleMenu()">‚úï</button>
    </div>
    <nav class="menu-nav">
      <a routerLink="/main" class="menu-item">
        <span class="material-icons">inventory_2</span>
        Stock General
      </a>
      <a routerLink="/productos" class="menu-item">
        <span class="material-icons">shopping_cart</span>
        Productos
      </a>
      <a routerLink="/proveedores" class="menu-item">
        <span class="material-icons">local_shipping</span>
        Proveedores
      </a>
      <a routerLink="/clientes" class="menu-item">
        <span class="material-icons">people</span>
        Clientes
      </a>
      <a routerLink="/cotizaciones" class="menu-item">
        <span class="material-icons">description</span>
        Cotizaciones
      </a>
      <a routerLink="/configuracion" class="menu-item active">
        <span class="material-icons">settings</span>
        Configuraci√≥n
      </a>
      <a routerLink="/login" class="menu-item logout">
        <span class="material-icons">logout</span>
        Cerrar Sesi√≥n
      </a>
    </nav>
  </div>

  <div class="menu-overlay" *ngIf="menuAbierto" (click)="toggleMenu()"></div>

  <div class="content-area config-container">
    
    <div class="mensaje-exito" *ngIf="mensajeExito">
      {{ mensajeExito }}
    </div>

    <div class="config-card">
      <div class="card-header">
        <span class="material-icons">account_circle</span>
        <h2>Informaci√≥n del Usuario</h2>
      </div>
      <div class="card-content">
        <div class="info-row">
          <span class="info-label">Nombre de usuario:</span>
          <span class="info-value">{{ userName }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Correo electr√≥nico:</span>
          <span class="info-value">{{ userEmail }}</span>
        </div>
      </div>
    </div>

    <div class="config-card">
      <div class="card-header">
        <span class="material-icons">palette</span>
        <h2>Apariencia</h2>
      </div>
      <div class="card-content">
        <div class="setting-row">
          <div class="setting-info">
            <label class="setting-label">Tema de la aplicaci√≥n</label>
            <p class="setting-description">Cambia entre modo claro y oscuro</p>
          </div>
          
          <div class="theme-toggle-group">
            <button 
              class="theme-btn" 
              [class.active]="temaActual === 'dark'"
              (click)="seleccionarTema('dark')"
            >
              üåô Oscuro
            </button>
            <button 
              class="theme-btn" 
              [class.active]="temaActual === 'light'"
              (click)="seleccionarTema('light')"
            >
              ‚òÄÔ∏è Claro
            </button>
          </div>

        </div>
      </div>
    </div>

    <div class="config-card">
      <div class="card-header">
        <span class="material-icons">security</span>
        <h2>Seguridad</h2>
      </div>
      <div class="card-content">
        <div class="setting-row">
          <div class="setting-info">
            <label class="setting-label">Contrase√±a</label>
            <p class="setting-description">Cambia tu contrase√±a de acceso</p>
          </div>
          <button class="btn-change-password" (click)="abrirModalPassword()">
            <span class="material-icons">lock_reset</span>
            Cambiar Contrase√±a
          </button>
        </div>
      </div>
    </div>

    <div class="config-card">
      <div class="card-header">
        <span class="material-icons">logout</span>
        <h2>Sesi√≥n</h2>
      </div>
      <div class="card-content">
        <div class="setting-row">
          <div class="setting-info">
            <label class="setting-label">Cerrar sesi√≥n</label>
            <p class="setting-description">Cierra tu sesi√≥n actual</p>
          </div>
          <button class="btn-logout" (click)="cerrarSesion()">
            <span class="material-icons">exit_to_app</span>
            Cerrar Sesi√≥n
          </button>
        </div>
      </div>
    </div>

  </div>

  @if (showModalPassword()) {
    <div class="modal-overlay-centered">
      <div class="modal-content-password">
        <div class="modal-header">
          <h2>Cambiar Contrase√±a</h2>
          <button class="close-button" (click)="cerrarModalPassword()" type="button">‚úï</button>
        </div>

        <form class="password-form" (ngSubmit)="cambiarPassword()">
          
          <div class="mensaje-error" *ngIf="mensajeError">
            {{ mensajeError }}
          </div>

          <div class="mensaje-exito" *ngIf="mensajeExito">
            {{ mensajeExito }}
          </div>

          <div class="form-group">
            <label>Contrase√±a Actual *</label>
            <div class="password-input-wrapper">
              <input 
                [type]="mostrarPasswordActual ? 'text' : 'password'"
                [(ngModel)]="passwordActual" 
                name="passwordActual"
                placeholder="Ingresa tu contrase√±a actual"
                required
                autocomplete="current-password"
              >
              <button 
                type="button" 
                class="toggle-password" 
                (click)="togglePasswordActual()"
              >
                <span class="material-icons">
                  {{ mostrarPasswordActual ? 'visibility_off' : 'visibility' }}
                </span>
              </button>
            </div>
          </div>

          <div class="form-group">
            <label>Nueva Contrase√±a *</label>
            <div class="password-input-wrapper">
              <input 
                [type]="mostrarPasswordNueva ? 'text' : 'password'"
                [(ngModel)]="passwordNueva" 
                name="passwordNueva"
                placeholder="Ingresa tu nueva contrase√±a (m√≠nimo 6 caracteres)"
                required
                autocomplete="new-password"
              >
              <button 
                type="button" 
                class="toggle-password" 
                (click)="togglePasswordNueva()"
              >
                <span class="material-icons">
                  {{ mostrarPasswordNueva ? 'visibility_off' : 'visibility' }}
                </span>
              </button>
            </div>
          </div>

          <div class="form-group">
            <label>Confirmar Nueva Contrase√±a *</label>
            <div class="password-input-wrapper">
              <input 
                [type]="mostrarPasswordConfirmar ? 'text' : 'password'"
                [(ngModel)]="passwordConfirmar" 
                name="passwordConfirmar"
                placeholder="Confirma tu nueva contrase√±a"
                required
                autocomplete="new-password"
              >
              <button 
                type="button" 
                class="toggle-password" 
                (click)="togglePasswordConfirmar()"
              >
                <span class="material-icons">
                  {{ mostrarPasswordConfirmar ? 'visibility_off' : 'visibility' }}
                </span>
              </button>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" (click)="cerrarModalPassword()">
              Cancelar
            </button>
            <button type="submit" class="btn-primary" [disabled]="isLoading()">
              {{ isLoading() ? 'Cambiando...' : 'Cambiar Contrase√±a' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  }
</div>